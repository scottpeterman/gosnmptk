# vendor_fingerprints.yaml
version: "1.0"
metadata:
  description: "SNMP vendor fingerprinting configuration"
  last_updated: "2025-01-15"
  contributors: ["team", "community"]

# Common OIDs used across vendors
common_oids:
  system_description: "1.3.6.1.2.1.1.1.0"
  system_object_id: "1.3.6.1.2.1.1.2.0"
  system_uptime: "1.3.6.1.2.1.1.3.0"
  system_contact: "1.3.6.1.2.1.1.4.0"
  system_name: "1.3.6.1.2.1.1.5.0"
  system_location: "1.3.6.1.2.1.1.6.0"
  system_services: "1.3.6.1.2.1.1.7.0"

# Generic fallback OIDs for unknown vendors
generic_oids:
  - name: "Entity Model Name"
    oid: "1.3.6.1.2.1.47.1.1.1.1.13.1"
    priority: 1
    description: "Standard Entity MIB model name"
  - name: "Entity Serial Number"
    oid: "1.3.6.1.2.1.47.1.1.1.1.11.1"
    priority: 1
    description: "Standard Entity MIB serial number"
  - name: "Entity Hardware Revision"
    oid: "1.3.6.1.2.1.47.1.1.1.1.8.1"
    priority: 2
    description: "Standard Entity MIB hardware revision"

# Vendor-specific configurations
vendors:
  # Add BlueCat Networks
  bluecat:
    display_name: "BlueCat Networks"
    enterprise_oid: "1.3.6.1.4.1.13315"
    detection_patterns:
      - "bluecat"
      - "adonis"
      - "proteus"
    oid_patterns:
      - "1.3.6.1.4.1.13315."
      - "bluecat"
    device_types:
      - "dns_server"
      - "dhcp_server"
      - "ipam"
    fingerprint_oids:
      - name: "BlueCat System Info"
        oid: "1.3.6.1.4.1.13315.2.1"
        priority: 1
        description: "BlueCat system information"
        definitive: true
      - name: "BlueCat Version"
        oid: "1.3.6.1.4.1.13315.2.1.1.0"
        priority: 1
        description: "BlueCat software version"

  # Add Zebra Technologies
  zebra:
    display_name: "Zebra Technologies"
    enterprise_oid: "1.3.6.1.4.1.10642"
    detection_patterns:
      - "zebra"
      - "zt231"
      - "zt610" 
      - "zt411"
      - "zd410"
      - "zd420"
      - "thermal printer"
      - "label printer"
    oid_patterns:
      - "1.3.6.1.4.1.10642."
      - "zebra"
    device_types:
      - "thermal_printer"
      - "label_printer"
    exclusion_patterns:
      - "lexmark"
      - "hp"
      - "cisco"
    fingerprint_oids:
      - name: "Zebra Model"
        oid: "1.3.6.1.4.1.10642.1.1.1.0"
        priority: 1
        description: "Zebra printer model"
        definitive: true
      - name: "Zebra Serial Number"
        oid: "1.3.6.1.4.1.10642.1.1.2.0"
        priority: 1
        description: "Zebra printer serial number"
      - name: "Zebra Firmware Version"
        oid: "1.3.6.1.4.1.10642.1.1.3.0"
        priority: 1
        description: "Zebra firmware version"
      - name: "Zebra Status"
        oid: "1.3.6.1.2.1.25.3.2.1.5.1"
        priority: 2
        description: "Standard printer status"

  # Add Lexmark before Aruba to prevent misclassification
  lexmark:
    display_name: "Lexmark International"
    enterprise_oid: "1.3.6.1.4.1.641"
    detection_patterns:
      - "lexmark"
      - "mx822ade"
      - "mx820"
      - "cx943adxse"
      - "cx410de"
      - "cx820"
      - "ms823dn"
      - "mxtgw"
      - "cxtpc"
      - "cxtpp"
      - "msngw"
      - "nh41"
    oid_patterns:
      - "1.3.6.1.4.1.641."
      - "lexmark"
      - "mxtgw"
      - "cxtpc"
      - "cxtpp"
      - "msngw"
    device_types:
      - "printer"
      - "multifunction_printer"
    fingerprint_oids:
      - name: "Lexmark Model"
        oid: "1.3.6.1.4.1.641.2.1.2.1.2.1"
        priority: 1
        description: "Lexmark printer model"
      - name: "Lexmark Firmware Version"
        oid: "1.3.6.1.4.1.641.2.1.2.1.3.1"
        priority: 1
        description: "Lexmark firmware version"
      - name: "Lexmark Serial Number"
        oid: "1.3.6.1.4.1.641.2.1.2.1.6.1"
        priority: 1
        description: "Lexmark serial number"
      - name: "Printer Status"
        oid: "1.3.6.1.2.1.25.3.2.1.5.1"
        priority: 2
        description: "Standard printer status"

  # Add ION (new vendor with enterprise OID 50114)
  ion:
    display_name: "ION Networks"
    enterprise_oid: "1.3.6.1.4.1.50114"
    detection_patterns:
      - "ion 3000"
    oid_patterns:
      - "1.3.6.1.4.1.50114."
    device_types:
      - "network_device"
      - "gateway"
    # Add exclusion patterns to prevent Cisco misclassification
    exclusion_patterns:
      - "cisco"
      - "ios"
      - "catalyst"
      - "cupertino"
    fingerprint_oids:
      - name: "ION Model"
        oid: "1.3.6.1.4.1.50114.11.1.10.3000"
        priority: 1
        description: "ION device model identifier"
        definitive: true
      - name: "ION System Info"
        oid: "1.3.6.1.4.1.50114.11.1.10.3000"
        priority: 1
        description: "ION 3000 system information"

  # Add CloudGenix/Prisma SD-WAN
  palo_alto_sdwan:
    display_name: "Palo Alto Networks (CloudGenix/Prisma SD-WAN)"
    enterprise_oid: "1.3.6.1.4.1.25461"
    detection_patterns:
      - "ion 3000"
      - "ion 1000"
      - "ion 2000"
      - "ion 5000"
      - "ion 7000"
      - "ion 9000"
      - "cloudgenix"
      - "prisma sd-wan"
      - "prisma sdwan"
    oid_patterns:
      - "1.3.6.1.4.1.25461."
      - "ion 3000"
      - "ion 1000"
      - "ion 2000"
      - "cloudgenix"
      - "prisma"
    device_types:
      - "sdwan_gateway"
      - "edge_device"
      - "wan_optimizer"
    fingerprint_oids:
      - name: "Ion Model"
        oid: "1.3.6.1.4.1.25461.2.1.2.2.1.0"
        priority: 1
        description: "CloudGenix Ion model"
      - name: "Ion Serial Number"
        oid: "1.3.6.1.4.1.25461.2.1.2.2.3.0"
        priority: 1
        description: "CloudGenix Ion serial number"
      - name: "Ion Software Version"
        oid: "1.3.6.1.4.1.25461.2.1.2.2.2.0"
        priority: 1
        description: "CloudGenix Ion software version"

  cisco:
    display_name: "Cisco Systems"
    enterprise_oid: "1.3.6.1.4.1.9"
    detection_patterns:
      - "cisco"
      - "ios"
      - "nx-os"
      - "asa"
      - "catalyst"
      - "nexus"
      - "cupertino"
    oid_patterns:
      - "1.3.6.1.4.1.9."
      - "cisco"
      - "ios"
      - "nx-os"
      - "catalyst"
    device_types:
      - "switch"
      - "router"
      - "firewall"
    # Add exclusion patterns to prevent ION misclassification
    exclusion_patterns:
      - "ion 3000"
    fingerprint_oids:
      - name: "Cisco Catalyst Model"
        oid: "1.3.6.1.4.1.9.1.2694"
        priority: 1
        description: "Cisco Catalyst switch model"
        device_types: ["switch"]
        definitive: true
      - name: "Cisco Catalyst Old Model"
        oid: "1.3.6.1.4.1.9.1.2137"
        priority: 1
        description: "Cisco Catalyst switch (older model)"
        device_types: ["switch"]
        definitive: true
      - name: "IOS Version"
        oid: "1.3.6.1.2.1.47.1.1.1.1.9.1001"
        priority: 1
        description: "Cisco IOS version from Entity MIB"
        device_types: ["switch", "router"]
      - name: "IOS Average CPU (5 Minutes)"
        oid: "1.3.6.1.4.1.9.2.1.58.0"
        priority: 2
        description: "Cisco IOS CPU utilization (5 minute average)"
        device_types: ["switch", "router"]
      - name: "Total Flash Old IOS"
        oid: "1.3.6.1.4.1.9.2.10.1.0"
        priority: 2
        description: "Total flash memory (older IOS)"
        device_types: ["switch", "router"]
      - name: "Free Flash Old IOS"
        oid: "1.3.6.1.4.1.9.2.10.2.0"
        priority: 2
        description: "Free flash memory (older IOS)"
        device_types: ["switch", "router"]
      - name: "Cisco Software Version"
        oid: "1.3.6.1.4.1.9.9.25.1.1.1.2.2"
        priority: 1
        description: "Cisco-specific software version"
        device_types: ["switch", "router"]
      - name: "Cisco Platform"
        oid: "1.3.6.1.4.1.9.3.6.11.0"
        priority: 1
        description: "Cisco platform identifier"
      - name: "Cisco IOS Version String"
        oid: "1.3.6.1.4.1.9.9.25.1.1.1.2.5"
        priority: 1
        description: "IOS version string"
      - name: "Cisco Model"
        oid: "1.3.6.1.2.1.47.1.1.1.1.13.1"
        priority: 5
        description: "Entity MIB model (lower priority)"

  arista:
    display_name: "Arista Networks"
    enterprise_oid: "1.3.6.1.4.1.30065"
    detection_patterns:
      - "arista"
      - "eos"
    oid_patterns:
      - "1.3.6.1.4.1.30065."
      - "arista"
      - "eos"
    device_types:
      - "switch"
      - "router"
    fingerprint_oids:
      - name: "Arista EOS Version"
        oid: "1.3.6.1.4.1.30065.3.1.1.0"
        priority: 1
        description: "Arista EOS software version"
        definitive: true
      - name: "Arista EOS Build"
        oid: "1.3.6.1.4.1.30065.3.1.2.0"
        priority: 1
        description: "Arista EOS build information"

aruba:
    display_name: "Aruba Networks (HPE)"
    enterprise_oid: "1.3.6.1.4.1.11"
    detection_patterns:
      - "aruba"
      - "arubaos"
      - "procurve switch"
      - "aruba networks"
      - "jl"
      - "jg"
      - "jx"
      - "cx"
      - "instant"
    oid_patterns:
      - "1.3.6.1.4.1.11.2.14.11."
      - "1.3.6.1.4.1.47196."
      - "1.3.6.1.4.1.14823."
      - "aruba"
      - "procurve switch"
      - "arubaos"
    device_types:
      - "switch"
      - "wireless_controller"
      - "access_point"
    exclusion_patterns:
      - "lexmark"
      - "mxtgw"
      - "cxtpc"
      - "cxtpp"
      - "msngw"
      - "nh41"
    device_type_overrides:
      access_point:
        - "arubaos (model:"
        - ") ssr"
        - "instant"
      switch:
        - "swch"
        - "procurve"
        - "jl675a"
        - "6100"
        - "6200"
        - "6300"
        - "6400"
      wireless_controller:
        - "wireless lan controller"
        - "mobility controller"
        - "7005"
        - "7210"
        - "7240"
        - "9004"
        - "9012"
    fingerprint_oids:
      - name: "HP Entity Module Description"
        oid: "1.3.6.1.4.1.11.2.14.11.1.2.3.1.4.1"
        priority: 1
        description: "HP networking module description"
        device_types: ["switch"]
      - name: "Aruba CX Model"
        oid: "1.3.6.1.4.1.47196.4.1.1.3.8.2.1.1.1.4.1"
        priority: 1
        description: "Aruba CX switch model"
        device_types: ["switch"]
      - name: "Aruba Wireless Model"
        oid: "1.3.6.1.4.1.14823.2.2.1.1.1.2.0"
        priority: 1
        description: "Aruba wireless controller model"
        device_types: ["wireless_controller"]
      - name: "Aruba OS Version"
        oid: "1.3.6.1.4.1.14823.2.3.3.1.1.4.0"
        priority: 1
        definitive: true
        description: "Aruba AOS Version"
        device_types: ["wireless_controller", "access_point"]

  hp_network:
    display_name: "HP Network Interfaces"
    enterprise_oid: "1.3.6.1.4.1.11"
    detection_patterns:
      - "hp ethernet multi-environment"
      - "hp ethernet"
      - "hp jetdirect"
      - "jetdirect"
      - "hp network"
      - "hewlett-packard ethernet"
      - "hpbea"
      - "hpjet"
    oid_patterns:
      - "1.3.6.1.4.1.11.2.4.3."
      - "1.3.6.1.4.1.11.2.3.7."
      - "jetdirect"
      - "hp ethernet"
    device_types:
      - "print_server"
      - "network_interface"
    fingerprint_oids:
      - name: "JetDirect Model"
        oid: "1.3.6.1.4.1.11.2.4.3.1.1.3.1.0"
        priority: 1
        description: "HP JetDirect model identification"
      - name: "JetDirect Firmware"
        oid: "1.3.6.1.4.1.11.2.4.3.1.1.3.2.0"
        priority: 1
        description: "HP JetDirect firmware version"
      - name: "Network Interface Status"
        oid: "1.3.6.1.4.1.11.2.4.3.1.1.2.1.0"
        priority: 2
        description: "HP network interface status"

  hp_printer:
    display_name: "HP Printers"
    enterprise_oid: "1.3.6.1.4.1.11"
    detection_patterns:
      - "laserjet"
      - "officejet"
      - "deskjet"
      - "envy"
      - "photosmart"
      - "pagewide"
      - "latex"
      - "designjet"
      - "printer"
    oid_patterns:
      - "1.3.6.1.4.1.11.2.3.9."
      - "1.3.6.1.4.1.11.2.4.3."
      - "laserjet"
      - "officejet"
      - "printer"
    device_types:
      - "printer"
    exclusion_patterns:
      # Don't detect as HP printer if these are present
      - "switch"
      - "router"
      - "aruba"
      - "procurve"
      - "lexmark"
    fingerprint_oids:
      - name: "HP Printer Model"
        oid: "1.3.6.1.4.1.11.2.3.9.4.2.1.1.3.3.0"
        priority: 1
        description: "HP printer model name"
      - name: "Printer Status"
        oid: "1.3.6.1.2.1.25.3.2.1.5.1"
        priority: 2
        description: "Standard printer status"

  dell:
    display_name: "Dell Technologies"
    enterprise_oid: "1.3.6.1.4.1.674"
    detection_patterns:
      - "dell"
      - "idrac"
      - "powerconnect"
      - "force10"
      - "poweredge"
    oid_patterns:
      - "1.3.6.1.4.1.674."
      - "dell"
      - "idrac"
    device_types:
      - "server"
      - "switch"
      - "storage"
    fingerprint_oids:
      - name: "Dell Chassis Service Tag"
        oid: "1.3.6.1.4.1.674.10892.5.1.3.2.0"
        priority: 1
        description: "Dell service tag"
      - name: "Dell Chassis Model"
        oid: "1.3.6.1.4.1.674.10892.5.1.3.12.0"
        priority: 1
        description: "Dell chassis model"
      - name: "iDRAC Version"
        oid: "1.3.6.1.4.1.674.10892.5.1.1.12.0"
        priority: 1
        description: "iDRAC firmware version"

  fortinet:
    display_name: "Fortinet"
    enterprise_oid: "1.3.6.1.4.1.12356"
    detection_patterns:
      - "fortinet"
      - "fortigate"
      - "fortiswitch"
      - "fortiap"
      - "fortiwifi"
    oid_patterns:
      - "1.3.6.1.4.1.12356."
      - "fortinet"
      - "fortigate"
    device_types:
      - "firewall"
      - "switch"
      - "access_point"
    fingerprint_oids:
      - name: "Fortinet Model"
        oid: "1.3.6.1.4.1.12356.101.1.2.1.0"
        priority: 1
        description: "Fortinet device model"
      - name: "Fortinet Serial Number"
        oid: "1.3.6.1.4.1.12356.101.1.2.2.0"
        priority: 1
        description: "Fortinet serial number"

  palo_alto:
    display_name: "Palo Alto Networks"
    enterprise_oid: "1.3.6.1.4.1.25461"
    detection_patterns:
      - "palo alto"
      - "pan-os"
      - "panorama"
    oid_patterns:
      - "1.3.6.1.4.1.25461."
      - "palo alto"
      - "pan-os"
    device_types:
      - "firewall"
      - "management"
    # Add exclusion patterns to prevent confusion with SD-WAN
    exclusion_patterns:
      - "ion 1000"
      - "ion 2000"
      - "ion 3000"
      - "ion 5000"
      - "ion 7000"
      - "ion 9000"
      - "cloudgenix"
    fingerprint_oids:
      - name: "Palo Alto Device Identifier"
        oid: "1.3.6.1.4.1.25461.2.3.36"
        priority: 1
        description: "Palo Alto device identifier"
        definitive: true
      - name: "Palo Alto OS Version"
        oid: "1.3.6.1.4.1.25461.2.1.2.1.1.0"
        priority: 1
        description: "Palo Alto PAN-OS version"
        definitive: true
      - name: "Palo Alto Verification"
        oid: "1.3.6.1.4.1.25461.2.1.2.1.14.0"
        priority: 1
        description: "Palo Alto vendor verification (should return 'paloaltonetworks')"
        expected_values: ["paloaltonetworks"]
        definitive: true
      - name: "PAN Model"
        oid: "1.3.6.1.4.1.25461.2.1.2.1.1.0"
        priority: 1
        description: "Palo Alto model"
      - name: "PAN Serial Number"
        oid: "1.3.6.1.4.1.25461.2.1.2.1.3.0"
        priority: 1
        description: "Palo Alto serial number"

  apc:
    display_name: "APC (Schneider Electric)"
    enterprise_oid: "1.3.6.1.4.1.318"
    detection_patterns:
      - "apc"
      - "schneider"
      - "powerware"
    oid_patterns:
      - "1.3.6.1.4.1.318."
      - "apc"
    device_types:
      - "ups"
      - "pdu"
    fingerprint_oids:
      - name: "APC Model Number"
        oid: "1.3.6.1.4.1.318.1.1.1.1.1.1.0"
        priority: 1
        description: "APC UPS model"
      - name: "APC Model Number 2"
        oid: "1.3.6.1.4.1.318.1.1.1.1.1.1.0"
        priority: 1
        description: "APC UPS model Alt"
      - name: "APC Version"
        oid: " .1.3.6.1.4.1.318.1.1.12.1.3.0"
        priority: 1
        description: "APC UPS OS Version"
        definitive: true

# Detection rules and priorities
detection_rules:
  # Order matters - first match wins for ambiguous cases
  priority_order:
    - "bluecat"         # Check BlueCat first
    - "lexmark"         # Check Lexmark first to prevent Aruba misclassification
    - "zebra"           # Check Zebra thermal printers
    - "palo_alto_sdwan" # Check CloudGenix/Prisma SD-WAN before general Palo Alto
    - "hp_printer"      # Check printers before general HP networking
    - "hp_network"
    - "cisco"           # Move Cisco before ION to prevent misclassification
    - "ion"             # Check ION after Cisco
    - "arista"
    - "palo_alto"
    - "fortinet"
    - "dell"
    - "aruba"           # After lexmark to avoid conflicts
    - "apc"
  
  confidence_levels:
    high: "Multiple vendor-specific OIDs successful"
    medium: "Basic detection + some vendor OIDs"
    low: "Basic detection only"
    none: "No vendor detected"

# Configuration for scanning behavior
scanning:
  default_timeout: 30  # seconds
  oid_query_timeout: 10  # seconds per OID
  delay_between_queries: 100  # milliseconds
  max_concurrent_queries: 5
  retry_failed_oids: true
  retry_count: 2# vendor_fingerprints.yaml - Complete merger with all OID research
version: "2.2"
metadata:
  description: "Enhanced SNMP vendor fingerprinting with complete OID research and definitive matching"
  last_updated: "2025-07-27"
  contributors: ["team", "community"]

# Common OIDs used across vendors
common_oids:
  system_description: "1.3.6.1.2.1.1.1.0"
  system_object_id: "1.3.6.1.2.1.1.2.0"
  system_uptime: "1.3.6.1.2.1.1.3.0"
  system_contact: "1.3.6.1.2.1.1.4.0"
  system_name: "1.3.6.1.2.1.1.5.0"
  system_location: "1.3.6.1.2.1.1.6.0"
  system_services: "1.3.6.1.2.1.1.7.0"

# Generic fallback OIDs for unknown vendors
generic_oids:
  - name: "Entity Model Name"
    oid: "1.3.6.1.2.1.47.1.1.1.1.13.1"
    priority: 1
    description: "Standard Entity MIB model name"
  - name: "Entity Serial Number"
    oid: "1.3.6.1.2.1.47.1.1.1.1.11.1"
    priority: 1
    description: "Standard Entity MIB serial number"
  - name: "Entity Hardware Revision"
    oid: "1.3.6.1.2.1.47.1.1.1.1.8.1"
    priority: 2
    description: "Standard Entity MIB hardware revision"

# Detection rules with strict priority
detection_rules:
  # CRITICAL: Order matters - most specific vendors first
  priority_order:
    - "dell_idrac"      # Check iDRAC before general Dell
    - "hp_ilo"          # Check iLO before general HP
    - "cisco_cimc"      # Check CIMC before general Cisco
    - "bluecat"         # Check BlueCat first
    - "lexmark"         # Check Lexmark first to prevent Aruba misclassification
    - "zebra"           # Check Zebra thermal printers
    - "apc"             # Check power devices (very specific patterns)
    - "fortinet"        # Enhanced Fortinet detection
    - "palo_alto"       # Check Palo Alto before ION (they both use similar OID space)
    - "aruba"           # Check Aruba BEFORE ION (critical fix)
    - "ion"             # Check ION after Aruba and Palo Alto (prevents misclassification)
    - "cisco"           # Check Cisco after ION
    - "arista"
    - "dell"
    - "hp_printer"      # Check printers before general HP networking
    - "hp_network"

  confidence_levels:
    high: "Multiple vendor-specific OIDs successful"
    medium: "Basic detection + some vendor OIDs"
    low: "Basic detection only"
    none: "No vendor detected"

# Vendor-specific configurations
vendors:
  # LEXMARK - Enhanced with complete OID research and patterns from scan data
  lexmark:
    display_name: "Lexmark International"
    enterprise_oid: "1.3.6.1.4.1.641"

    # Definitive patterns for 100% confidence matching
    definitive_patterns:
      - pattern: "lexmark"
        confidence: 100
        description: "Lexmark identification"
      - pattern: "lexmark cx522"
        confidence: 100
        description: "Lexmark CX522 series"
      - pattern: "lexmark cx532"
        confidence: 100
        description: "Lexmark CX532 series"
      - pattern: "cxtzj."
        confidence: 95
        description: "Lexmark CX522 firmware signature"
      - pattern: "cxtgv."
        confidence: 95
        description: "Lexmark CX532 firmware signature"

    detection_patterns:
      - "lexmark"
      - "mx822ade"
      - "mx820"
      - "cx943adxse"
      - "cx410de"
      - "cx820"
      - "ms823dn"
      - "mxtgw"
      - "cxtpc"
      - "cxtpp"
      - "msngw"
      - "nh41"
      # Enhanced patterns from scan data
      - "cx522ade"
      - "cx532adwe"
      - "cx532adw"
      - "cxtzj."
      - "cxtgv."
      - "yocto-standard"

    oid_patterns:
      - "1.3.6.1.4.1.641."
      - "lexmark"
      - "mxtgw"
      - "cxtpc"
      - "cxtpp"
      - "msngw"

    exclusion_patterns:
      - "aruba"
      - "cisco"
      - "hp"
      - "apc"

    device_type_rules:
      multifunction_printer:
        priority: 1
        definitive_patterns:
          - "all-n-1"
          - "cx532adwe"
          - "cx522ade"
          - "cx532adw"
        description: "Lexmark multifunction printers"

      printer:
        priority: 2
        definitive_patterns:
          - "lexmark"
          - "cx522"
          - "cx532"
          - "mx822"
          - "ms823"
        description: "Lexmark printers"

    device_types:
      - "printer"
      - "multifunction_printer"

    fingerprint_oids:
      - name: "Lexmark Model"
        oid: "1.3.6.1.4.1.641.2.1.2.1.2.1"
        priority: 1
        description: "Lexmark printer model"
        definitive: true
      - name: "Lexmark Firmware Version"
        oid: "1.3.6.1.4.1.641.2.1.2.1.3.1"
        priority: 1
        description: "Lexmark firmware version"
        definitive: true
      - name: "Lexmark Serial Number"
        oid: "1.3.6.1.4.1.641.2.1.2.1.6.1"
        priority: 1
        description: "Lexmark serial number"
      - name: "Printer Status"
        oid: "1.3.6.1.2.1.25.3.2.1.5.1"
        priority: 2
        description: "Standard printer status"

    model_extraction:
      - regex: "lexmark ([a-z0-9]+)"
        priority: 1
        capture_group: 1
        description: "Lexmark model"
      - regex: "lexmark (cx5[0-9]+\\w+)"
        priority: 1
        capture_group: 1
        description: "Lexmark CX5xx series model"
      - regex: "lexmark (mx[0-9]+\\w+)"
        priority: 1
        capture_group: 1
        description: "Lexmark MX series model"

    serial_extraction:
      - regex: "serial number: ([a-z0-9-]+)"
        priority: 1
        capture_group: 1
        description: "Lexmark serial number"

    firmware_extraction:
      - regex: "version\\s+(CXTZJ\\.[0-9]+\\.[0-9]+)"
        priority: 1
        capture_group: 1
        description: "Lexmark CX522 firmware"
      - regex: "version\\s+(CXTGV\\.[0-9]+\\.[0-9]+)"
        priority: 1
        capture_group: 1
        description: "Lexmark CX532 firmware"
      - regex: "version\\s+(MX[A-Z]+\\.[0-9]+\\.[0-9]+)"
        priority: 1
        capture_group: 1
        description: "Lexmark MX series firmware"

  # ZEBRA - Enhanced with complete OID research
  zebra:
    display_name: "Zebra Technologies"
    enterprise_oid: "1.3.6.1.4.1.10642"

    definitive_patterns:
      - pattern: "zebra"
        confidence: 100
        description: "Zebra identification"

    detection_patterns:
      - "zebra"
      - "zt231"
      - "zt610"
      - "zt411"
      - "zd410"
      - "zd420"
      - "thermal printer"
      - "label printer"

    oid_patterns:
      - "1.3.6.1.4.1.10642."
      - "zebra"

    exclusion_patterns:
      - "lexmark"
      - "hp"
      - "cisco"
      - "aruba"

    device_type_rules:
      label_printer:
        priority: 1
        definitive_patterns:
          - "zebra"
          - "thermal printer"
          - "label printer"
        description: "Zebra label/thermal printers"

    device_types:
      - "thermal_printer"
      - "label_printer"

    fingerprint_oids:
      - name: "Zebra Model"
        oid: "1.3.6.1.4.1.10642.1.1.1.0"
        priority: 1
        description: "Zebra printer model"
        definitive: true
      - name: "Zebra Serial Number"
        oid: "1.3.6.1.4.1.10642.1.1.2.0"
        priority: 1
        description: "Zebra printer serial number"
      - name: "Zebra Firmware Version"
        oid: "1.3.6.1.4.1.10642.1.1.3.0"
        priority: 1
        description: "Zebra firmware version"
      - name: "Zebra Status"
        oid: "1.3.6.1.2.1.25.3.2.1.5.1"
        priority: 2
        description: "Standard printer status"

  # APC - Enhanced with complete OID research
  apc:
    display_name: "APC (Schneider Electric)"
    enterprise_oid: "1.3.6.1.4.1.318"

    definitive_patterns:
      - pattern: "apc web/snmp management card"
        confidence: 100
        description: "APC management card"
      - pattern: "smart-ups"
        confidence: 100
        description: "APC Smart-UPS"
      - pattern: "apc"
        confidence: 100
        description: "APC identification"

    detection_patterns:
      - "apc"
      - "schneider"
      - "powerware"
      - "smart-ups"

    oid_patterns:
      - "1.3.6.1.4.1.318."
      - "apc"

    exclusion_patterns:
      - "aruba"
      - "cisco"
      - "lexmark"
      - "palo alto"

    device_type_rules:
      ups:
        priority: 1
        definitive_patterns:
          - "smart-ups"
          - "su_"
        description: "APC UPS devices"

      pdu:
        priority: 2
        definitive_patterns:
          - "rpdu"
          - "ap7920b"
        description: "APC PDU devices"

    device_types:
      - "ups"
      - "pdu"

    fingerprint_oids:
      - name: "APC Model Number"
        oid: "1.3.6.1.4.1.318.1.1.1.1.1.1.0"
        priority: 1
        description: "APC UPS model"
        definitive: true
      - name: "APC Model Number Alt"
        oid: "1.3.6.1.4.1.318.1.1.1.1.1.1.0"
        priority: 1
        description: "APC UPS model Alt"
      - name: "APC Version"
        oid: "1.3.6.1.4.1.318.1.1.12.1.3.0"
        priority: 1
        description: "APC UPS OS Version"
        definitive: true

    model_extraction:
      - regex: "mn:([a-z0-9]+)"
        priority: 1
        capture_group: 1
        description: "APC model from description"

    serial_extraction:
      - regex: "sn: ([a-z0-9]+)"
        priority: 1
        capture_group: 1
        description: "APC serial from description"

    firmware_extraction:
      - regex: "af1:v([0-9.]+)"
        priority: 1
        capture_group: 1
        description: "APC firmware version"

  # PALO ALTO - Enhanced with complete OID research (check before ION)
  palo_alto:
    display_name: "Palo Alto Networks"
    enterprise_oid: "1.3.6.1.4.1.25461"

    definitive_patterns:
      - pattern: "palo alto networks"
        confidence: 100
        description: "Palo Alto Networks identification"
      - pattern: "pa-[0-9]+ series"
        confidence: 100
        description: "Palo Alto PA-series devices"
      - pattern: "pan-os"
        confidence: 100
        description: "PAN-OS operating system"

    detection_patterns:
      - "palo alto"
      - "pan-os"
      - "panorama"
      - "pa-220"
      - "pa-850"
      - "pa-3020"
      - "pa-5220"

    oid_patterns:
      - "1.3.6.1.4.1.25461."
      - "palo alto"
      - "pan-os"

    # CRITICAL: Exclude ION patterns to prevent conflicts
    exclusion_patterns:
      - "ion 1000"
      - "ion 2000"
      - "ion 3000"
      - "ion 5000"
      - "ion 7000"
      - "ion 9000"
      - "cloudgenix"
      - "aruba"
      - "cisco"

    device_type_rules:
      firewall:
        priority: 1
        definitive_patterns:
          - "firewall"
          - "pa-[0-9]+ series"
        mandatory_patterns:
          - "palo alto"
        description: "Palo Alto firewall devices"

    device_types:
      - "firewall"
      - "management"

    fingerprint_oids:
      - name: "Palo Alto Device Identifier"
        oid: "1.3.6.1.4.1.25461.2.3.36"
        priority: 1
        description: "Palo Alto device identifier"
        definitive: true
      - name: "Palo Alto OS Version"
        oid: "1.3.6.1.4.1.25461.2.1.2.1.1.0"
        priority: 1
        description: "Palo Alto PAN-OS version"
        definitive: true
      - name: "Palo Alto Verification"
        oid: "1.3.6.1.4.1.25461.2.1.2.1.14.0"
        priority: 1
        description: "Palo Alto vendor verification (should return 'paloaltonetworks')"
        expected_values: ["paloaltonetworks"]
        definitive: true
      - name: "PAN Model"
        oid: "1.3.6.1.4.1.25461.2.1.2.1.1.0"
        priority: 1
        description: "Palo Alto model"
      - name: "PAN Serial Number"
        oid: "1.3.6.1.4.1.25461.2.1.2.1.3.0"
        priority: 1
        description: "Palo Alto serial number"

    model_extraction:
      - regex: "pa-([0-9]+)"
        priority: 1
        capture_group: 1
        description: "Palo Alto model extraction"
      - regex: "pa-([0-9]+) series"
        priority: 2
        capture_group: 1
        description: "Palo Alto series model extraction"

    serial_extraction:
      - regex: "serial number: ([a-z0-9]+)"
        priority: 1
        capture_group: 1
        description: "Palo Alto serial number"

    firmware_extraction:
      - regex: "pan-os ([0-9]+\\.[0-9]+[^\\s]*)"
        priority: 1
        capture_group: 1
        description: "PAN-OS version"

  # ARUBA - Enhanced with complete OID research to catch devices before ION misclassifies them
  aruba:
    display_name: "Aruba Networks (HPE)"
    enterprise_oid: "1.3.6.1.4.1.11"

    # DEFINITIVE patterns - if ANY of these match, it's definitely Aruba
    definitive_patterns:
      - pattern: "arubaos"
        confidence: 100
        description: "ArubaOS is unique to Aruba devices"
      - pattern: "aruba j"
        confidence: 100
        description: "Aruba J-series switches"
      - pattern: "procurve switch"
        confidence: 100
        description: "ProCurve is HP/Aruba networking brand"
      - pattern: "instant"
        confidence: 100
        description: "Aruba Instant APs"

    detection_patterns:
      - "aruba"
      - "arubaos"
      - "procurve switch"
      - "aruba networks"
      - "jl"
      - "jg"
      - "jx"
      - "cx"
      - "instant"

    oid_patterns:
      - "1.3.6.1.4.1.11.2.14.11."
      - "1.3.6.1.4.1.47196."
      - "1.3.6.1.4.1.14823."
      - "aruba"
      - "procurve switch"
      - "arubaos"

    # CRITICAL: Strong exclusions prevent ION false positives
    exclusion_patterns:
      - "ion 1200"
      - "ion 2000"
      - "ion 3000"
      - "entity model name: ion"
      - "cisco model: ion"
      - "lexmark"
      - "mxtgw"
      - "cxtpc"
      - "cxtpp"
      - "msngw"
      - "nh41"
      - "ilo"
      - "integrated lights-out"
      - "apc web/snmp"
      - "palo alto"

    device_type_rules:
      access_point:
        priority: 1
        definitive_patterns:
          - "arubaos"
          - "model:"
          - ") ssr"
        mandatory_patterns:
          - "arubaos"
        description: "Aruba wireless access points"

      switch:
        priority: 2
        definitive_patterns:
          - "aruba j"
          - "procurve"
          - "swch"
          - "6100"
          - "6200"
          - "6300"
          - "6400"
        description: "Aruba switches"

      wireless_controller:
        priority: 3
        definitive_patterns:
          - "wireless lan controller"
          - "mobility controller"
          - "7005"
          - "7210"
          - "7240"
          - "9004"
          - "9012"
        description: "Aruba wireless controllers"

    device_types:
      - "switch"
      - "wireless_controller"
      - "access_point"

    fingerprint_oids:
      - name: "HP Entity Module Description"
        oid: "1.3.6.1.4.1.11.2.14.11.1.2.3.1.4.1"
        priority: 1
        description: "HP networking module description"
        device_types: ["switch"]
        definitive: true
      - name: "Aruba CX Model"
        oid: "1.3.6.1.4.1.47196.4.1.1.3.8.2.1.1.1.4.1"
        priority: 1
        description: "Aruba CX switch model"
        device_types: ["switch"]
      - name: "Aruba Wireless Model"
        oid: "1.3.6.1.4.1.14823.2.2.1.1.1.2.0"
        priority: 1
        description: "Aruba wireless controller model"
        device_types: ["wireless_controller"]
      - name: "Aruba OS Version"
        oid: "1.3.6.1.4.1.14823.2.3.3.1.1.4.0"
        priority: 1
        definitive: true
        description: "Aruba AOS Version"
        device_types: ["wireless_controller", "access_point"]

    # Field extraction rules
    model_extraction:
      - regex: "model: ([0-9]+)"
        priority: 1
        capture_group: 1
        device_types: ["access_point"]
        description: "Aruba AP model number"
      - regex: "aruba (jl[0-9]+a?)"
        priority: 2
        capture_group: 1
        device_types: ["switch"]
        description: "Aruba switch model"

    serial_extraction:
      - regex: "entity serial number: ([a-z0-9]+)"
        priority: 1
        capture_group: 1
        description: "Entity MIB serial number"

    firmware_extraction:
      - regex: "version ([0-9]+\\.[0-9]+\\.[0-9]+[^\\s]*)"
        priority: 1
        capture_group: 1
        description: "ArubaOS version"

  # ION - Enhanced with better patterns and definitive OIDs
  ion:
    display_name: "ION Networks"
    enterprise_oid: "1.3.6.1.4.1.50114"

    # DEFINITIVE patterns - must match one of these to be ION
    definitive_patterns:
      - pattern: "ion 1200"
        confidence: 100
        description: "ION 1200 model (any variant)"
      - pattern: "ion 2000"
        confidence: 100
        description: "ION 2000 model (any variant)"
      - pattern: "ion 3000"
        confidence: 100
        description: "ION 3000 model (any variant)"
      - pattern: "entity model name: ion 1200"
        confidence: 100
        description: "ION 1200 via Entity MIB"
      - pattern: "entity model name: ion 2000"
        confidence: 100
        description: "ION 2000 via Entity MIB"
      - pattern: "entity model name: ion 3000"
        confidence: 100
        description: "ION 3000 via Entity MIB"
      - pattern: "cisco model: ion"
        confidence: 100
        description: "ION via Cisco MIB"

    detection_patterns:
      - "ion 1000"
      - "ion 2000"
      - "ion 3000"
      - "ion 5000"
      - "ion 7000"
      - "ion 9000"

    oid_patterns:
      - "1.3.6.1.4.1.50114."
      - "ion 3000"
      - "ion 1000"
      - "ion 2000"

    # CRITICAL: Exclude Aruba and Palo Alto patterns to prevent false positives
    exclusion_patterns:
      - "arubaos"
      - "aruba networks"
      - "model: 515"
      - "model: 505"
      - "model: 325"
      - ") ssr"
      - "instant"
      - "procurve"
      - "jl675a"
      - "palo alto"
      - "pan-os"
      - "firewall"

    device_type_rules:
      sdwan_gateway:
        priority: 1
        definitive_patterns:
          - "ion 1200"
          - "ion 2000"
          - "ion 3000"
        mandatory_patterns:
          - "ion"
        description: "ION SD-WAN gateway devices"

    device_types:
      - "sdwan_gateway"
      - "edge_device"
      - "wan_optimizer"

    fingerprint_oids:
      - name: "ION Model"
        oid: "1.3.6.1.4.1.50114.11.1.10.3000"
        priority: 1
        description: "ION device model identifier"
        definitive: true
      - name: "ION 2000 Model"
        oid: "1.3.6.1.4.1.50114.11.1.10.2000"
        priority: 1
        description: "ION 2000 model identifier"
        definitive: true
      - name: "ION System Info"
        oid: "1.3.6.1.4.1.50114.11.1.10.3000"
        priority: 1
        description: "ION 3000 system information"

    model_extraction:
      - regex: "ion ([0-9]+)"
        priority: 1
        capture_group: 1
        description: "ION model number extraction"
      - regex: "ion ([0-9]+-[a-z]+)"
        priority: 2
        capture_group: 1
        description: "ION model with suffix extraction"
      - regex: "entity model name: ion ([0-9]+)"
        priority: 3
        capture_group: 1
        description: "ION model from Entity MIB"

    serial_extraction:
      - regex: "entity serial number: ([0-9-]+)"
        priority: 1
        capture_group: 1
        description: "ION serial from Entity MIB"

    firmware_extraction:
      - regex: "\\( ([0-9]+\\.[0-9]+\\.[0-9]+-[a-z0-9]+) \\)"
        priority: 1
        capture_group: 1
        description: "ION firmware version from parentheses"

  # CISCO - Enhanced with comprehensive OID support
  cisco:
    display_name: "Cisco Systems"
    enterprise_oid: "1.3.6.1.4.1.9"

    definitive_patterns:
      - pattern: "cisco ios software"
        confidence: 100
        description: "Cisco IOS"
      - pattern: "cisco systems"
        confidence: 100
        description: "Cisco identification"

    detection_patterns:
      - "cisco"
      - "ios"
      - "nx-os"
      - "asa"
      - "catalyst"
      - "nexus"
      - "cupertino"

    oid_patterns:
      - "1.3.6.1.4.1.9."
      - "cisco"
      - "ios"
      - "nx-os"
      - "catalyst"

    # CRITICAL: Don't claim ION devices via Cisco MIBs
    exclusion_patterns:
      - "entity model name: ion"
      - "cisco model: ion"
      - "ion 1200"
      - "ion 2000"
      - "ion 3000"
      - "arubaos"
      - "aruba networks"
      - "palo alto"

    device_type_rules:
      switch:
        priority: 1
        definitive_patterns:
          - "catalyst"
          - "vios_l2"
        description: "Cisco switches"

    device_types:
      - "switch"
      - "router"
      - "firewall"

    fingerprint_oids:
      - name: "Cisco Catalyst Model"
        oid: "1.3.6.1.4.1.9.1.2694"
        priority: 1
        description: "Cisco Catalyst switch model"
        device_types: ["switch"]
        definitive: true
      - name: "Cisco Catalyst Old Model"
        oid: "1.3.6.1.4.1.9.1.2137"
        priority: 1
        description: "Cisco Catalyst switch (older model)"
        device_types: ["switch"]
        definitive: true
      - name: "IOS Version"
        oid: "1.3.6.1.2.1.47.1.1.1.1.9.1001"
        priority: 1
        description: "Cisco IOS version from Entity MIB"
        device_types: ["switch", "router"]
      - name: "IOS Average CPU (5 Minutes)"
        oid: "1.3.6.1.4.1.9.2.1.58.0"
        priority: 2
        description: "Cisco IOS CPU utilization (5 minute average)"
        device_types: ["switch", "router"]
      - name: "Total Flash Old IOS"
        oid: "1.3.6.1.4.1.9.2.10.1.0"
        priority: 2
        description: "Total flash memory (older IOS)"
        device_types: ["switch", "router"]
      - name: "Free Flash Old IOS"
        oid: "1.3.6.1.4.1.9.2.10.2.0"
        priority: 2
        description: "Free flash memory (older IOS)"
        device_types: ["switch", "router"]
      - name: "Cisco Software Version"
        oid: "1.3.6.1.4.1.9.9.25.1.1.1.2.2"
        priority: 1
        description: "Cisco-specific software version"
        device_types: ["switch", "router"]
      - name: "Cisco Platform"
        oid: "1.3.6.1.4.1.9.3.6.11.0"
        priority: 1
        description: "Cisco platform identifier"
      - name: "Cisco IOS Version String"
        oid: "1.3.6.1.4.1.9.9.25.1.1.1.2.5"
        priority: 1
        description: "IOS version string"
      - name: "Cisco Model"
        oid: "1.3.6.1.2.1.47.1.1.1.1.13.1"
        priority: 5
        description: "Entity MIB model (lower priority)"

    model_extraction:
      - regex: "catalyst ([a-z0-9-]+)"
        priority: 1
        capture_group: 1
        description: "Cisco Catalyst model"

  # Enhanced Cisco CIMC Management Interface
  cisco_cimc:
    display_name: "Cisco Integrated Management Controller (CIMC)"
    enterprise_oid: "1.3.6.1.4.1.9"

    definitive_patterns:
      - pattern: "cisco integrated management controller"
        confidence: 100
        description: "CIMC identification"
      - pattern: "cimc"
        confidence: 100
        description: "CIMC identification"

    detection_patterns:
      - "cisco integrated management controller"
      - "cimc"
      - "ucs c-series"
      - "ucs c220"
      - "ucs c240"
      - "ucs c480"
      - "cisco ucs"

    oid_patterns:
      - "1.3.6.1.4.1.9.9.719."
      - "1.3.6.1.4.1.9.9.685."
      - "cimc"
      - "ucs c-series"

    device_types:
      - "server_management"
      - "bmc"
      - "server"

    fingerprint_oids:
      - name: "CIMC Version"
        oid: "1.3.6.1.4.1.9.9.719.1.9.1.0"
        priority: 1
        description: "Cisco CIMC firmware version"
        definitive: true
      - name: "UCS Chassis Model"
        oid: "1.3.6.1.4.1.9.9.719.1.1.1.1.2.1"
        priority: 1
        description: "UCS server chassis model"
      - name: "UCS Serial Number"
        oid: "1.3.6.1.4.1.9.9.719.1.1.1.1.3.1"
        priority: 1
        description: "UCS server serial number"
      - name: "CIMC Model"
        oid: "1.3.6.1.4.1.9.9.685.1.1.0"
        priority: 1
        description: "CIMC model identifier"

  # FORTINET - Enhanced with definitive OIDs
  fortinet:
    display_name: "Fortinet"
    enterprise_oid: "1.3.6.1.4.1.12356"

    definitive_patterns:
      - pattern: "fortinet"
        confidence: 100
        description: "Fortinet identification"
      - pattern: "fortigate"
        confidence: 100
        description: "FortiGate firewall"

    detection_patterns:
      - "fortinet"
      - "fortigate"
      - "fortiswitch"
      - "fortiap"
      - "fortiwifi"
      - "sd-wan hub"
      - "fgt_101f"
      - "fgt_60f"
      - "fgt_80f"
      - "fgt_100f"

    oid_patterns:
      - "1.3.6.1.4.1.12356."
      - "fortinet"
      - "fortigate"
      - "fgt_"

    exclusion_patterns:
      - "cisco"
      - "aruba"
      - "palo alto"
      - "ion"

    device_type_rules:
      firewall:
        priority: 1
        definitive_patterns:
          - "fortigate"
        description: "Fortinet firewalls"

    device_types:
      - "firewall"
      - "switch"
      - "access_point"
      - "sdwan_gateway"

    fingerprint_oids:
      - name: "Fortinet Model"
        oid: "1.3.6.1.4.1.12356.101.1.2.1.0"
        priority: 1
        description: "Fortinet device model"
        definitive: true
      - name: "Fortinet Serial Number"
        oid: "1.3.6.1.4.1.12356.101.1.2.2.0"
        priority: 1
        description: "Fortinet serial number"
      - name: "FortiOS Version"
        oid: "1.3.6.1.4.1.12356.101.4.1.1.0"
        priority: 1
        description: "FortiOS firmware version"
        definitive: true
      - name: "Fortinet System Status"
        oid: "1.3.6.1.4.1.12356.101.4.1.3.0"
        priority: 2
        description: "Fortinet system operational status"

  # ARISTA - With definitive OIDs

  arista:
    display_name: "Arista Networks"
    enterprise_oid: "1.3.6.1.4.1.30065"
    detection_patterns:
      - "arista"
      - "eos"
    oid_patterns:
      - "1.3.6.1.4.1.30065."
      - "arista"
      - "eos"
    device_types:
      - "switch"
      - "router"
    device_type_rules:
      switch:
        priority: 1
        definitive_patterns:
          - "eos version"
          - "arista networks"
        description: "Arista switches running EOS"
    fingerprint_oids:
      - name: "Arista EOS Version"
        oid: "1.3.6.1.4.1.30065.3.1.1.0"
        priority: 1
        description: "Arista EOS software version"
      - name: "Arista EOS Build"
        oid: "1.3.6.1.4.1.30065.3.1.2.0"
        priority: 1
        description: "Arista EOS build information"

#  arista:
#    display_name: "Arista Networks"
#    enterprise_oid: "1.3.6.1.4.1.30065"
#
#    definitive_patterns:
#      - pattern: "arista"
#        confidence: 100
#        description: "Arista identification"
#      - pattern: "eos"
#        confidence: 90
#        description: "Arista EOS"
#
#    detection_patterns:
#      - "arista"
#      - "eos"
#
#    oid_patterns:
#      - "1.3.6.1.4.1.30065."
#      - "arista"
#      - "eos"
#
#    exclusion_patterns:
#      - "cisco"
#      - "aruba"
#      - "palo alto"
#      - "ion"
#
#    device_types:
#      - "switch"
#      - "router"
#
#    fingerprint_oids:
#      - name: "Arista EOS Version"
#        oid: "1.3.6.1.4.1.30065.3.1.1.0"
#        priority: 1
#        description: "Arista EOS software version"
#        definitive: true
#      - name: "Arista EOS Build"
#        oid: "1.3.6.1.4.1.30065.3.1.2.0"
#        priority: 1
#        description: "Arista EOS build information"

  # Enhanced Dell with separate iDRAC detection
  dell:
    display_name: "Dell Technologies"
    enterprise_oid: "1.3.6.1.4.1.674"

    definitive_patterns:
      - pattern: "dell"
        confidence: 100
        description: "Dell identification"

    detection_patterns:
      - "dell"
      - "powerconnect"
      - "force10"
      - "poweredge"

    oid_patterns:
      - "1.3.6.1.4.1.674."
      - "dell"

    device_types:
      - "server"
      - "switch"
      - "storage"

    exclusion_patterns:
      - "idrac"
      - "integrated dell remote access"

    fingerprint_oids:
      - name: "Dell Chassis Service Tag"
        oid: "1.3.6.1.4.1.674.10892.5.1.3.2.0"
        priority: 1
        description: "Dell service tag"
      - name: "Dell Chassis Model"
        oid: "1.3.6.1.4.1.674.10892.5.1.3.12.0"
        priority: 1
        description: "Dell chassis model"

  # Separate Dell iDRAC Management Interface
  dell_idrac:
    display_name: "Dell Integrated Dell Remote Access Controller (iDRAC)"
    enterprise_oid: "1.3.6.1.4.1.674"

    definitive_patterns:
      - pattern: "idrac"
        confidence: 100
        description: "iDRAC identification"
      - pattern: "integrated dell remote access"
        confidence: 100
        description: "Dell Remote Access Controller"

    detection_patterns:
      - "idrac"
      - "integrated dell remote access"
      - "dell remote access controller"
      - "OpenManage Enterprise Modular"
      - "idrac6"
      - "idrac7"
      - "idrac8"
      - "idrac9"

    oid_patterns:
      - "1.3.6.1.4.1.674.10892."
      - "idrac"
      - "integrated dell remote access"

    device_types:
      - "idrac"
      - "bmc"
      - "server"
    device_type_rules:
      switch:
        priority: 1
        definitive_patterns:
          - "idrac"
          - "OpenManage Enterprise Modular"
    fingerprint_oids:
      - name: "iDRAC Version"
        oid: "1.3.6.1.4.1.674.10892.5.1.1.12.0"
        priority: 1
        description: "iDRAC firmware version"
        definitive: true
      - name: "Dell Server Model"
        oid: "1.3.6.1.4.1.674.10892.5.1.3.12.0"
        priority: 1
        description: "Dell PowerEdge server model"
      - name: "Dell Server Service Tag"
        oid: "1.3.6.1.4.1.674.10892.5.1.3.2.0"
        priority: 1
        description: "Dell server service tag"
      - name: "iDRAC System Status"
        oid: "1.3.6.1.4.1.674.10892.5.2.1.0"
        priority: 2
        description: "iDRAC overall system status"
      - name: "Server Power State"
        oid: "1.3.6.1.4.1.674.10892.5.4.200.10.1.4.1"
        priority: 2
        description: "Server power state"


  # Enhanced HP iLO Management Interface
  hp_ilo:
    display_name: "HP Integrated Lights-Out (iLO)"
    enterprise_oid: "1.3.6.1.4.1.232"

    definitive_patterns:
      - pattern: "integrated lights-out"
        confidence: 100
        description: "HP iLO identification"
      - pattern: "ilo"
        confidence: 100
        description: "iLO identification"

    detection_patterns:
      - "integrated lights-out"
      - "ilo"
      - "ilo2"
      - "ilo3"
      - "ilo4"
      - "ilo5"
      - "hp proliant"
      - "hpe proliant"

    oid_patterns:
      - "1.3.6.1.4.1.232."
      - "ilo"
      - "integrated lights-out"
      - "proliant"

    device_types:
      - "server_management"
      - "bmc"
      - "server"

    fingerprint_oids:
      - name: "iLO Version"
        oid: "1.3.6.1.4.1.232.9.2.9.1.1.0"
        priority: 1
        description: "HP iLO firmware version"
        definitive: true
      - name: "Server Model"
        oid: "1.3.6.1.4.1.232.2.2.4.2.0"
        priority: 1
        description: "HP/HPE server model"
      - name: "Server Serial Number"
        oid: "1.3.6.1.4.1.232.2.2.2.1.0"
        priority: 1
        description: "HP/HPE server serial number"
      - name: "iLO Management Engine Status"
        oid: "1.3.6.1.4.1.232.9.2.2.1.1.0"
        priority: 2
        description: "iLO management engine status"
      - name: "Server Health Status"
        oid: "1.3.6.1.4.1.232.6.2.6.1.0"
        priority: 2
        description: "Overall server health status"

  # HP Network Interfaces
  hp_network:
    display_name: "HP Network Interfaces"
    enterprise_oid: "1.3.6.1.4.1.11"

    definitive_patterns:
      - pattern: "hp ethernet multi-environment"
        confidence: 100
        description: "HP Ethernet identification"
      - pattern: "jetdirect"
        confidence: 100
        description: "HP JetDirect identification"

    detection_patterns:
      - "hp ethernet multi-environment"
      - "hp ethernet"
      - "hp jetdirect"
      - "jetdirect"
      - "hp network"
      - "hewlett-packard ethernet"
      - "hpbea"
      - "hpjet"

    oid_patterns:
      - "1.3.6.1.4.1.11.2.4.3."
      - "1.3.6.1.4.1.11.2.3.7."
      - "jetdirect"
      - "hp ethernet"

    device_types:
      - "print_server"
      - "network_interface"

    exclusion_patterns:
      - "ilo"
      - "integrated lights-out"
      - "proliant"
      - "aruba"
      - "procurve"

    fingerprint_oids:
      - name: "JetDirect Model"
        oid: "1.3.6.1.4.1.11.2.4.3.1.1.3.1.0"
        priority: 1
        description: "HP JetDirect model identification"
        definitive: true
      - name: "JetDirect Firmware"
        oid: "1.3.6.1.4.1.11.2.4.3.1.1.3.2.0"
        priority: 1
        description: "HP JetDirect firmware version"
      - name: "Network Interface Status"
        oid: "1.3.6.1.4.1.11.2.4.3.1.1.2.1.0"
        priority: 2
        description: "HP network interface status"

  # HP Printers
  hp_printer:
    display_name: "HP Printers"
    enterprise_oid: "1.3.6.1.4.1.11"

    definitive_patterns:
      - pattern: "laserjet"
        confidence: 100
        description: "HP LaserJet identification"
      - pattern: "officejet"
        confidence: 100
        description: "HP OfficeJet identification"

    detection_patterns:
      - "laserjet"
      - "officejet"
      - "deskjet"
      - "envy"
      - "photosmart"
      - "pagewide"
      - "latex"
      - "designjet"
      - "printer"

    oid_patterns:
      - "1.3.6.1.4.1.11.2.3.9."
      - "1.3.6.1.4.1.11.2.4.3."
      - "laserjet"
      - "officejet"
      - "printer"

    device_types:
      - "printer"

    exclusion_patterns:
      - "switch"
      - "router"
      - "aruba"
      - "procurve"
      - "lexmark"
      - "ilo"
      - "integrated lights-out"

    fingerprint_oids:
      - name: "HP Printer Model"
        oid: "1.3.6.1.4.1.11.2.3.9.4.2.1.1.3.3.0"
        priority: 1
        description: "HP printer model name"
        definitive: true
      - name: "Printer Status"
        oid: "1.3.6.1.2.1.25.3.2.1.5.1"
        priority: 2
        description: "Standard printer status"

  # BlueCat - DNS/DHCP/IPAM
  bluecat:
    display_name: "BlueCat Networks"
    enterprise_oid: "1.3.6.1.4.1.13315"

    definitive_patterns:
      - pattern: "bluecat"
        confidence: 100
        description: "BlueCat identification"

    detection_patterns:
      - "bluecat"
      - "adonis"
      - "proteus"

    oid_patterns:
      - "1.3.6.1.4.1.13315."
      - "bluecat"

    device_types:
      - "dns_server"
      - "dhcp_server"
      - "ipam"

    fingerprint_oids:
      - name: "BlueCat System Info"
        oid: "1.3.6.1.4.1.13315.2.1"
        priority: 1
        description: "BlueCat system information"
        definitive: true
      - name: "BlueCat Version"
        oid: "1.3.6.1.4.1.13315.2.1.1.0"
        priority: 1
        description: "BlueCat software version"

# Configuration for scanning behavior
scanning:
  default_timeout: 30  # seconds
  oid_query_timeout: 10  # seconds per OID
  delay_between_queries: 100  # milliseconds
  max_concurrent_queries: 5
  retry_failed_oids: true
  retry_count: 2

# Global field extraction fallbacks (used after vendor identification)
global_field_extraction:
  serial_patterns:
    - regex: "serial number: ([a-z0-9-]+)"
      priority: 90
      description: "Generic serial format"
    - regex: "sn: ([a-z0-9]+)"
      priority: 91
      description: "Generic SN format"

  model_patterns:
    - regex: "model: ([a-z0-9]+)"
      priority: 90
      description: "Generic model format"

  version_patterns:
    - regex: "version ([0-9]+\\.[0-9]+\\.[0-9]+[^\\s]*)"
      priority: 90
      description: "Generic version format"